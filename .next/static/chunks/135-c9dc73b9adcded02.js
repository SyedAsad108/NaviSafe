(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[135],{6601:function(){},1371:function(){},6127:function(){},5613:function(e,t,r){"use strict";r.d(t,{X:function(){return l},bZ:function(){return s}});var n=r(7437);r(2265);var a=r(535),o=r(4508);let i=(0,a.j)("relative w-full rounded-lg border px-4 py-3 text-sm grid has-[>svg]:grid-cols-[calc(var(--spacing)*4)_1fr] grid-cols-[0_1fr] has-[>svg]:gap-x-3 gap-y-0.5 items-start [&>svg]:size-4 [&>svg]:translate-y-0.5 [&>svg]:text-current",{variants:{variant:{default:"bg-card text-card-foreground",destructive:"text-destructive bg-card [&>svg]:text-current *:data-[slot=alert-description]:text-destructive/90"}},defaultVariants:{variant:"default"}});function s(e){let{className:t,variant:r,...a}=e;return(0,n.jsx)("div",{"data-slot":"alert",role:"alert",className:(0,o.cn)(i({variant:r}),t),...a})}function l(e){let{className:t,...r}=e;return(0,n.jsx)("div",{"data-slot":"alert-description",className:(0,o.cn)("text-muted-foreground col-start-2 grid justify-items-start gap-1 text-sm [&_p]:leading-relaxed",t),...r})}},5974:function(e,t,r){"use strict";r.d(t,{C:function(){return l}});var n=r(7437);r(2265);var a=r(7053),o=r(535),i=r(4508);let s=(0,o.j)("inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&>svg]:size-3 gap-1 [&>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground [a&]:hover:bg-primary/90",secondary:"border-transparent bg-secondary text-secondary-foreground [a&]:hover:bg-secondary/90",destructive:"border-transparent bg-destructive text-white [a&]:hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"text-foreground [a&]:hover:bg-accent [a&]:hover:text-accent-foreground"}},defaultVariants:{variant:"default"}});function l(e){let{className:t,variant:r,asChild:o=!1,...l}=e,c=o?a.g7:"span";return(0,n.jsx)(c,{"data-slot":"badge",className:(0,i.cn)(s({variant:r}),t),...l})}},2869:function(e,t,r){"use strict";r.d(t,{z:function(){return l}});var n=r(7437);r(2265);var a=r(7053),o=r(535),i=r(4508);let s=(0,o.j)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",{variants:{variant:{default:"bg-primary text-primary-foreground shadow-xs hover:bg-primary/90",destructive:"bg-destructive text-white shadow-xs hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50",secondary:"bg-secondary text-secondary-foreground shadow-xs hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2 has-[>svg]:px-3",sm:"h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5",lg:"h-10 rounded-md px-6 has-[>svg]:px-4",icon:"size-9"}},defaultVariants:{variant:"default",size:"default"}});function l(e){let{className:t,variant:r,size:o,asChild:l=!1,...c}=e,d=l?a.g7:"button";return(0,n.jsx)(d,{"data-slot":"button",className:(0,i.cn)(s({variant:r,size:o,className:t})),...c})}},6070:function(e,t,r){"use strict";r.d(t,{Ol:function(){return i},Zb:function(){return o},aY:function(){return l},ll:function(){return s}});var n=r(7437);r(2265);var a=r(4508);function o(e){let{className:t,...r}=e;return(0,n.jsx)("div",{"data-slot":"card",className:(0,a.cn)("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",t),...r})}function i(e){let{className:t,...r}=e;return(0,n.jsx)("div",{"data-slot":"card-header",className:(0,a.cn)("@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-1.5 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6",t),...r})}function s(e){let{className:t,...r}=e;return(0,n.jsx)("div",{"data-slot":"card-title",className:(0,a.cn)("leading-none font-semibold",t),...r})}function l(e){let{className:t,...r}=e;return(0,n.jsx)("div",{"data-slot":"card-content",className:(0,a.cn)("px-6",t),...r})}},5186:function(e,t,r){"use strict";r.d(t,{I:function(){return o}});var n=r(7437);r(2265);var a=r(4508);function o(e){let{className:t,type:r,...o}=e;return(0,n.jsx)("input",{type:r,"data-slot":"input",className:(0,a.cn)("file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input flex h-9 w-full min-w-0 rounded-md border bg-transparent px-3 py-1 text-base shadow-xs transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm","focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]","aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",t),...o})}},6815:function(e,t,r){"use strict";r.d(t,{_:function(){return i}});var n=r(7437);r(2265);var a=r(6394),o=r(4508);function i(e){let{className:t,...r}=e;return(0,n.jsx)(a.f,{"data-slot":"label",className:(0,o.cn)("flex items-center gap-2 text-sm leading-none font-medium select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50",t),...r})}},2339:function(e,t,r){"use strict";r.d(t,{SP:function(){return l},dr:function(){return s},mQ:function(){return i},nU:function(){return c}});var n=r(7437);r(2265);var a=r(1312),o=r(4508);function i(e){let{className:t,...r}=e;return(0,n.jsx)(a.fC,{"data-slot":"tabs",className:(0,o.cn)("flex flex-col gap-2",t),...r})}function s(e){let{className:t,...r}=e;return(0,n.jsx)(a.aV,{"data-slot":"tabs-list",className:(0,o.cn)("bg-muted text-muted-foreground inline-flex h-9 w-fit items-center justify-center rounded-lg p-[3px]",t),...r})}function l(e){let{className:t,...r}=e;return(0,n.jsx)(a.xz,{"data-slot":"tabs-trigger",className:(0,o.cn)("data-[state=active]:bg-background dark:data-[state=active]:text-foreground focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:outline-ring dark:data-[state=active]:border-input dark:data-[state=active]:bg-input/30 text-foreground dark:text-muted-foreground inline-flex h-[calc(100%-1px)] flex-1 items-center justify-center gap-1.5 rounded-md border border-transparent px-2 py-1 text-sm font-medium whitespace-nowrap transition-[color,box-shadow] focus-visible:ring-[3px] focus-visible:outline-1 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:shadow-sm [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",t),...r})}function c(e){let{className:t,...r}=e;return(0,n.jsx)(a.VY,{"data-slot":"tabs-content",className:(0,o.cn)("flex-1 outline-none",t),...r})}},7539:function(e,t,r){"use strict";r.d(t,{j:function(){return c}});var n=r(2265),a=r(4024),o=r(6615);class i{hashIdNumber(e){return(0,o.sha256)(e+"navisafe_salt_2024")}generateMockSignature(){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t="";for(let r=0;r<88;r++)t+=e.charAt(Math.floor(Math.random()*e.length));return t}async registerTourist(e,t){var r,n,o;try{let n,o,i;if(console.log("[v0] Starting tourist registration on blockchain..."),!e||!e.publicKey)throw Error("Wallet not connected or invalid");if(!t.registrationTimestamp||isNaN(t.registrationTimestamp))throw Error("Invalid registration timestamp");let s=e.publicKey,l=Date.now(),c="NVS-".concat(l,"-").concat(s.toString().slice(-8));console.log("[v0] Digital ID:",c);let d=this.hashIdNumber(t.idNumber);if(this.isDemoMode)console.log("[v0] Running in demo mode - simulating blockchain transaction..."),n=this.generateMockSignature(),o=Math.floor(1e6*Math.random())+2e8,i=Math.floor(Date.now()/1e3),await new Promise(e=>setTimeout(e,1500));else{let t;let l=new a.YW().add(a.yc.transfer({fromPubkey:s,toPubkey:s,lamports:0})),{blockhash:c}=await this.connection.getLatestBlockhash();l.recentBlockhash=c,l.feePayer=s;try{t=await e.signTransaction(l)}catch(e){if((null===(r=e.message)||void 0===r?void 0:r.includes("User rejected"))||4001===e.code)throw Error("Transaction cancelled by user. Please approve the transaction to complete registration.");throw e}n=await this.connection.sendRawTransaction(t.serialize()),await this.connection.confirmTransaction(n,"confirmed");let d=await this.connection.getTransaction(n,{commitment:"confirmed"});o=(null==d?void 0:d.slot)||0,i=(null==d?void 0:d.blockTime)||Math.floor(Date.now()/1e3)}console.log("[v0] Registration transaction signature:",n);let u=a.RG.generate().publicKey.toString(),g={digitalId:c,name:t.name,gender:t.gender,age:t.age,idNumberHash:d,phone:t.phone,nationality:t.nationality,email:t.email||null,registrationTimestamp:t.registrationTimestamp,userPublicKey:s.toString()};return this.mockStorage.set(c,g),console.log("[v0] Tourist data stored:",g),{signature:n,slot:o,blockTime:i,touristAccountAddress:u}}catch(e){if(console.error("[v0] Registration failed:",e),(null===(n=e.message)||void 0===n?void 0:n.includes("User rejected"))||(null===(o=e.message)||void 0===o?void 0:o.includes("cancelled")))throw Error("Registration cancelled. Please approve the wallet transaction to complete your registration.");throw Error("Registration failed: ".concat(e.message))}}async updateTripDetails(e,t,r){var n,o,i;try{let o,i,s;if(console.log("[v0] Updating trip details on blockchain..."),!e||!e.publicKey)throw Error("Wallet not connected or invalid");if(!r.startDate||!r.endDate||isNaN(r.startDate)||isNaN(r.endDate))throw Error("Invalid trip dates");let l=e.publicKey,c=this.mockStorage.get(t);if(!c)throw Error("Tourist registration not found. Please register first.");if(console.log("[v0] Updating tourist account for digital ID:",t),this.isDemoMode)console.log("[v0] Running in demo mode - simulating trip update transaction..."),o=this.generateMockSignature(),i=Math.floor(1e6*Math.random())+2e8,s=Math.floor(Date.now()/1e3),await new Promise(e=>setTimeout(e,1500));else{let t;let r=new a.YW().add(a.yc.transfer({fromPubkey:l,toPubkey:l,lamports:0})),{blockhash:c}=await this.connection.getLatestBlockhash();r.recentBlockhash=c,r.feePayer=l;try{t=await e.signTransaction(r)}catch(e){if((null===(n=e.message)||void 0===n?void 0:n.includes("User rejected"))||4001===e.code)throw Error("Transaction cancelled by user. Please approve the transaction to update your trip details.");throw e}o=await this.connection.sendRawTransaction(t.serialize()),await this.connection.confirmTransaction(o,"confirmed");let d=await this.connection.getTransaction(o,{commitment:"confirmed"});i=(null==d?void 0:d.slot)||0,s=(null==d?void 0:d.blockTime)||Math.floor(Date.now()/1e3)}console.log("[v0] Trip update transaction signature:",o);let d={...c,tripDetails:{startDate:r.startDate,endDate:r.endDate,purpose:r.purpose,accommodation:r.accommodation||null,itinerary:r.itinerary,emergencyContacts:r.emergencyContacts},lastUpdated:Date.now()};return this.mockStorage.set(t,d),console.log("[v0] Trip details updated:",d),{signature:o,slot:i,blockTime:s,touristAccountAddress:c.touristAccountAddress||a.RG.generate().publicKey.toString()}}catch(e){if(console.error("[v0] Trip update failed:",e),(null===(o=e.message)||void 0===o?void 0:o.includes("User rejected"))||(null===(i=e.message)||void 0===i?void 0:i.includes("cancelled")))throw Error("Update cancelled. Please approve the wallet transaction to update your trip details.");throw Error("Trip update failed: ".concat(e.message))}}async getTouristData(e,t){try{console.log("[v0] Fetching tourist data from blockchain...");let e=this.mockStorage.get(t);if(!e)throw Error("Tourist data not found");return console.log("[v0] Retrieved tourist data:",e),e}catch(e){throw console.error("[v0] Data retrieval failed:",e),Error("Data retrieval failed: ".concat(e.message))}}async verifyTransaction(e){try{if(this.isDemoMode)return 88===e.length;let t=await this.connection.getTransaction(e,{commitment:"confirmed"});return null!==t}catch(e){return console.error("[v0] Transaction verification failed:",e),!1}}getExplorerUrl(e){return"https://solscan.io/tx/".concat(e,"?cluster=devnet")}getAccountExplorerUrl(e){return"https://solscan.io/account/".concat(e,"?cluster=devnet")}getAllTouristData(){let e=[];for(let[t,r]of this.mockStorage.entries())e.push({digitalId:t,data:r});return e}constructor(){this.mockStorage=new Map,this.isDemoMode=!0,this.connection=new a.ew((0,a.Wf)("devnet"),"confirmed")}}let s=new i;var l=r(1035);function c(){let{wallet:e,connected:t}=(0,l.K)(),[r,a]=(0,n.useState)({isLoading:!1,error:null,result:null,isSuccess:!1}),o=(0,n.useCallback)(()=>{a({isLoading:!1,error:null,result:null,isSuccess:!1})},[]),i=(0,n.useCallback)(async r=>{if(!t||!e)return a(e=>({...e,error:"Wallet not connected"})),null;a({isLoading:!0,error:null,result:null,isSuccess:!1});try{console.log("[v0] Initiating tourist registration transaction...");let t=await s.registerTourist(e,r);return a({isLoading:!1,error:null,result:t,isSuccess:!0}),console.log("[v0] Tourist registration successful:",t),t}catch(e){return console.error("[v0] Tourist registration failed:",e),a({isLoading:!1,error:e.message||"Registration failed",result:null,isSuccess:!1}),null}},[t,e]),c=(0,n.useCallback)(async(r,n)=>{if(!t||!e)return a(e=>({...e,error:"Wallet not connected"})),null;a({isLoading:!0,error:null,result:null,isSuccess:!1});try{console.log("[v0] Initiating trip details update transaction...");let t=await s.updateTripDetails(e,r,n);return a({isLoading:!1,error:null,result:t,isSuccess:!0}),console.log("[v0] Trip details update successful:",t),t}catch(e){return console.error("[v0] Trip details update failed:",e),a({isLoading:!1,error:e.message||"Trip update failed",result:null,isSuccess:!1}),null}},[t,e]),d=(0,n.useCallback)(async e=>{try{return await s.verifyTransaction(e)}catch(e){return console.error("[v0] Transaction verification failed:",e),!1}},[]);return{...r,registerTourist:i,updateTripDetails:c,verifyTransaction:d,resetState:o,getExplorerUrl:s.getExplorerUrl,getAccountExplorerUrl:s.getAccountExplorerUrl}}},1035:function(e,t,r){"use strict";r.d(t,{K:function(){return o}});var n=r(2265),a=r(4024);function o(){let[e,t]=(0,n.useState)({wallet:null,publicKey:null,connected:!1,connecting:!1,balance:null,error:null}),r=(0,n.useRef)(new a.ew((0,a.Wf)("devnet"),"confirmed")),o=(0,n.useCallback)(()=>window.solana&&window.solana.isPhantom?window.solana:window.solflare&&window.solflare.isSolflare?window.solflare:null,[]),i=(0,n.useCallback)(async()=>{let e=o();if(!e)return t(e=>({...e,error:"No Solana wallet detected. Please install Phantom or Solflare wallet."})),!1;try{t(e=>({...e,connecting:!0,error:null}));let n=await e.connect(),a=n.publicKey.toString(),o=await r.current.getBalance(n.publicKey)/1e9;return t(t=>({...t,wallet:e,publicKey:a,connected:!0,connecting:!1,balance:o})),console.log("[v0] Wallet connected:",a),console.log("[v0] Wallet balance:",o,"SOL"),!0}catch(e){return console.error("[v0] Wallet connection failed:",e),t(t=>({...t,connecting:!1,error:e.message||"Failed to connect wallet"})),!1}},[o]),s=(0,n.useCallback)(async()=>{try{e.wallet&&await e.wallet.disconnect(),t({wallet:null,publicKey:null,connected:!1,connecting:!1,balance:null,error:null}),console.log("[v0] Wallet disconnected")}catch(e){console.error("[v0] Wallet disconnect failed:",e),t(t=>({...t,error:e.message||"Failed to disconnect wallet"}))}},[e.wallet]);return(0,n.useEffect)(()=>{let e=o();e&&e.isConnected&&i()},[]),(0,n.useEffect)(()=>{let e=o();if(e){let r=()=>{console.log("[v0] Wallet connected via event")},n=()=>{console.log("[v0] Wallet disconnected via event"),t({wallet:null,publicKey:null,connected:!1,connecting:!1,balance:null,error:null})};return e.on("connect",r),e.on("disconnect",n),()=>{e.off("connect",r),e.off("disconnect",n)}}},[]),{...e,connectWallet:i,disconnectWallet:s,connection:r.current,isWalletAvailable:!!o()}}},4508:function(e,t,r){"use strict";r.d(t,{cn:function(){return o}});var n=r(1994),a=r(3335);function o(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,a.m6)((0,n.W)(t))}}}]);